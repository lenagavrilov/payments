{% extends "search/layout.html" %}



{% block body %}
        
        <h1>Search for payment </h1>

         <form action="{% url 'search:index' %}" id="searchform" method="POST">
            {% csrf_token %}

            <div>
                <label for="paymentsKind">From Payment Kind: </label>
                <select name="frompaymentKind">
                    {% for paymentKind in paymentKinds %}   
                        <option value="{{ paymentKind.id }}"> {{paymentKind.id}}
                            <label>- {{ paymentKind.definition}}</label> 
                        </option>
                    {% endfor %}

                </select>  
                
                <label for="paymentsKind">To Payment Kind: </label>
                <select name="topaymentKind">
                    {% for paymentKind in paymentKinds %}   
                        <option value="{{ paymentKind.id }}" selected="selected"> {{paymentKind.id}}
                            <label>- {{ paymentKind.definition}}</label>
                        </option>
                    {% endfor %}
                </select> 
             </div>

             <div>
                <label for="checks">From Check </label>
                <select name="fromChecks">
                    {% for check in checks %}
                        <option value=" {{ check.checkNumber}}"> {{check.checkNumber}}</option>
                    {% endfor %}
                </select>
                <label for="checks">To Check </label>
                <select name="toChecks">
                    {% for check in checks %}
                        <option value=" {{ check.checkNumber}}" selected="selected"> {{check.checkNumber}}</option>
                    {% endfor %}
                </select>
             </div>
    
            <div>
                <label for="supplyer">From Supplyer</label>
                <select name='fromSupplyer'>
                    {% for supplyer in supplyers %}
                        <option  value="{{ supplyer.supplyerCode}} "
                        {% if supplyer.supplyerCode ==  fromSupplyers %}selected{% endif %}>
                         {{ supplyer.supplyerCode}} 
                            <label>- {{ supplyer.supplyerName }}</label>
                        </option>
                        
                    {% endfor %}
                </select>
                <label for="supplyer">To Supplyer</label>
                <select name="toSupplyer">
                    {% for supplyer in supplyers %}
                        <option value="{{ supplyer.supplyerCode}}" 
                        selected>
                         {{ supplyer.supplyerCode}}
                            <label>- {{ supplyer.supplyerName }}</label>
                        </option>
                    {% endfor %}
                </select>
            </div>
    
            <div>
                <label for='startDate'>From Date</label>
                <input name="paymentfromDate" type='date' value="{{ startDate }}">
                <label for='startDate'>To Date</label>
                <input name="paymentToDate" type='date' value="{{ finishDate }}">
                
            </div>
    
            <div>
                <label for="status">From Status</label>
                <select name='fromStatus'>
                    {% for status in statuses %}
                        <option value="{{ status.statusCode }}" >{{ status.statusCode }}
                            <label>- {{ status.definition }}</label>
                        </option>
                    {% endfor %}
                </select>
                <label for="status">To Status</label>
                <select name="toStatus">
                    {% for status in statuses %}
                        <option value="{{ status.statusCode }}" selected="selected">{{ status.statusCode }}
                            <label>- {{ status.definition }}</label>
                        </option>
                    {% endfor %}
                </select>
            </div>
 
              
            <div>
                <input type="checkbox" id="checkConcentrated">
                <label for="concentrated">Do concentrated report for</label>
                <select name="concentrated">
                    <option value="SUN">SUN</option>
                    <option value="MON">MON</option>
                    <option value="TUE">TUE</option>
                    <option value="WED" selected="selected">WED</option>
                    <option value="THU">THU</option>
                    <option value="FRI">FRI</option>
                    <option value="SAT">SAT</option>
                </select>
            </div>
        </div>
            <div>
                <input type="submit" value="Search" id="submitSearch">
            </div>
        

        </form>

        <div>
                <h3>Total:
                <label id="total">{{ total.amount__sum }} NIS.</label>
                
                Number of payments:
                <label id="totalCount">{{totalCount.amount__count}}.</label>
                </h3>
        </div>

        
        <table id="detailed">
            <thead>
                <tr>
                    {% for columnName in columnsNames %}
                        <th> {{ columnName }}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for payment in payments %}
                <tr>
                        <td>{{ payment.paymentKind }}</td>
                        <td> {{ payment.amount}}</td>
                        <td>{% if payment.checkNumber is not None %} 
                             {{ payment.checkNumber }}
                            {% else %}
                            -------
                            {% endif %}
                            
                        </td> 
                        <td> {{ payment.paymentDate|date:"d/m/Y" }}</td>
                        <td> {{ payment.supplyer }} </td>
                        <td> {{ payment.details }} </td>
                        <td> {{ payment.givenOutDate|date:"d/m/Y" }} </td>
                        <td> {{ payment.paymentNumberInSeries }} </td>
                        <td> {{ payment.quantityinSeries }} </td>
                        <td> {{ payment.status }} </td>
                        <td> {{ payment.refuseReason }} </td>
                        <td> {{ payment.refuseDate|date:"d/m/Y" }} </td>
                        <td> {{ payment.givenInstead }} </td>
                        <td> {{ payment.alternativeSupplyer }} </td>
                        <td> {{ payment.checkBook }} </td>
                    
                 </tr>
                 {% endfor %}
            </tbody>

        </table>

        <div>

        </div>
    
        <table id="concentrated">
            <thead>
                <tr>
                    <th>Day to pay</th>
                    <th>Amount to pay</th>
                    <th>Dates included</th>
                </tr>
            </thead>
            <tr>
                <td>25/01/21</td>
                <td>5000</td>
                <td>18/1/21 - 25/1/21</td>
            </tr>
        </table>

        <div>
            <h1>Payments: </h1>
            <ol>{%for payment in payments %}
                <li>
                    <a href="{% url 'search:payment' payment.id %}">
                    Payment: {{ payment.paymentKind }}, amount: {{ payment.amount }} to be paid on {{ payment.paymentDate }} </li>
                    </a>
                {% endfor %}

            </ol>
        </div>
    
        

{% endblock %}

